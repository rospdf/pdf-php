name: Build

on:
  push:
#    branches: [ master ]
  pull_request:

permissions:
  contents: read

jobs:
  build:
    name: Build
    runs-on: ubuntu-22.04

    strategy:
      matrix:
        php-version:
          - 5.6
          - 7.0
          - 7.1
          - 7.2
          - 7.3
          - 7.4
          - 8.0
          - 8.1

    steps:
      - uses: actions/checkout@v3
      - name: "Setup PHP ${{ matrix.php-version }}"
        uses: shivammathur/setup-php@v2
        with:
          php-version: ${{ matrix.php-version }}
      - name: Install dependencies
        run: composer install --no-interaction --prefer-source
      - name: Run PHP_CodeSniffer
        run: |
          vendor/bin/phpcs --standard=phpcs.xml src -s
          vendor/bin/phpcs --standard=phpcs.xml extensions -s
          vendor/bin/phpcs --standard=phpcs.xml examples -s
      - name: Run PHPUnit
        run: vendor/bin/phpunit
